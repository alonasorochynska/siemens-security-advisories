{% extends "base.html" %}

{% block title %}
<title>Vulnerabilities</title>
{% endblock %}

{% block content %}
<div class="container mt-4">
  <h4>Vulnerability List</h4>
  <table class="table table-bordered table-striped">
    <thead>
    <tr>
      <th>#</th>
      <th>CVE_ID</th>
      <th>CWE_ID</th>
      <th>CWE Name</th>
      <th>CVSS_Score</th>
      <th>Severity</th>
      <th>Products Affected</th>
    </tr>
    </thead>
    <tbody>
    {% for vulnerability in vulnerabilities %}
    <tr>
      <td>{{ forloop.counter }}</td>
      <td>{{ vulnerability.cve }}</td>
      <td style="white-space: nowrap;">
        <span title="{{ vulnerability.summary }}">
          {{ vulnerability.cwe_id }} <span style="color: blue; cursor: help; display: inline;">ℹ️</span>
        </span>
      </td>
      <td>{{ vulnerability.cwe_name }}</td>
      <td>
      <span title="{{ vulnerability.vector_string }}">
          {{ vulnerability.base_score }} <span style="color: blue; cursor: help; display: inline;">ℹ️</span>
        </span>
      </td>
      <td>{{ vulnerability.base_severity }}</td>
      <td>
        {% for product in vulnerability.products.all %}
          {{ product.name }}{% if not forloop.last %}, {% endif %}
        {% endfor %}
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="7" class="text-center">No vulnerabilities available.</td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
