{% extends "base.html" %}
{% load remediation_filter %}

{% block title %}
<title>Vulnerability Details - {{ vulnerability.cve }}</title>
{% endblock %}

{% block content %}
<div class="container mt-4">
  <h4>Vulnerability Details for <span class="detail-name">{{ vulnerability.cve }}</span></h4>

  <table class="table table-bordered table-striped">
  <thead>
    <tr>
      <th colspan="3">Vulnerability Information</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="width: 20px; white-space: nowrap;"><li></li></td>
      <td style="white-space: nowrap;">CVE ID</td>
      <td>{{ vulnerability.cve }}</td>
    </tr>
    <tr>
      <td><li></li></td>
      <td style="white-space: nowrap;">CWE ID</td>
      <td>{{ vulnerability.cwe_id }}</td>
    </tr>
    <tr>
      <td><li></li></td>
      <td style="white-space: nowrap;">CWE Name</td>
      <td>{{ vulnerability.cwe_name }}</td>
    </tr>
    <tr>
      <td><li></li></td>
      <td>Score</td>
      <td><b>{{ vulnerability.base_score }}</b></td>
    </tr>
    <tr>
      <td><li></li></td>
      <td>Severity</td>
      <td class="
        {% if vulnerability.base_severity == 'CRITICAL' %}
            text-critical
        {% elif vulnerability.base_severity == 'HIGH' %}
            text-high
        {% elif vulnerability.base_severity == 'MEDIUM' %}
            text-medium
        {% elif vulnerability.base_severity == 'LOW' %}
            text-low
        {% endif %}
      ">
        {{ vulnerability.base_severity }}
      </td>
    </tr>
    <tr>
      <td><li></li></td>
      <td style="white-space: nowrap;">CVSS Vector</td>
      <td>{{ vulnerability.vector_string }}</td>
    </tr>
    <tr>
      <td><li></li></td>
      <td>Summary</td>
      <td>{{ vulnerability.summary }}</td>
    </tr>
  </tbody>
</table>


  <h4>Related Products</h4>
  <table class="table table-bordered table-striped">
    <thead>
    <tr>
      <th style="width: 20px; white-space: nowrap;">#</th>
      <th style="width: 70%;" >Product Name</th>
      <th>Versions</th>
    </tr>
    </thead>
    <tbody>
    {% for product in vulnerability.products.all %}
    <tr>
      <td>{{ forloop.counter }}</td>
      <td><a href="{% url 'product_CVE:product_detail' product.id %}" class="product-link">{{ product.name }}</a></td>
      <td>{{ product.version_range }}</td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="3" class="text-center">No products associated with this vulnerability.</td>
    </tr>
    {% endfor %}
    </tbody>
  </table>

  <div class="mt-4">
    <button class="btn btn-outline-primary" onclick="history.back()">Go Back</button>
  </div>

</div>
{% endblock %}
